// Cria um input de arquivo
const input = document.createElement('input');
input.type = 'file';
input.accept = '.xlsx,.xls,.xlsm';
input.style.display = 'none';
document.body.appendChild(input);

// Quando selecionar arquivo
input.addEventListener('change', async (e) => {
  const file = e.target.files[0];
  if (!file) return;
  
  const formData = new FormData();
  formData.append('file', file);
  
  console.log('ğŸ“¤ Enviando arquivo:', file.name);
  
  try {
    const res = await fetch('https://agente-financeiro-mk-backend.onrender.com/finance/upload', {
      method: 'POST',
      body: formData,
    });
    
    const data = await res.json();
    console.log('ğŸ“¥ Resposta:', data);
    
    if (data.success) {
      alert(`âœ… Sucesso! ${data.imported} transaÃ§Ãµes importadas.`);
      location.reload(); // Recarrega a pÃ¡gina
    } else {
      alert(`âŒ Erro: ${data.message || data.error}`);
    }
  } catch (err) {
    console.error('Erro:', err);
    alert(`âŒ Erro: ${err.message}`);
  }
});

// Abre o seletor de arquivo
input.click();

